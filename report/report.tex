\documentclass[11pt]{article}
\usepackage[main=polish,english]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[hidelinks]{hyperref}
\usepackage{xcolor}
\usepackage{enumitem}
\usepackage[a4paper,inner=3.5cm,outer=2.5cm,top=2.5cm,bottom=2.5cm]{geometry}
\usepackage{newtxtext, newtxmath}
\usepackage{cleveref}


\setlist[itemize]{noitemsep}
\linespread{1.3} %interlinia 1.5
\setlength{\parindent}{1.25cm}

% the document is below

\title{Zastosowanie programowania ewolucyjnego w celu rozwiązania problemu
    komiwojażera}

\author{Maciej Wieczór-Retman, Kacper Stojek}

\date{} %leave blank

\begin{document}

\maketitle

\section{Wstęp}

Problem komiwojażera (ang. \textit{Traveling salesman problem}) jest problemem
minimalizacji, polegającym na odnalezieniu minimalnego cyklu Hamiltona w pełnym
grafie ważonym. Cykl Hamiltona to taki cykl w grafie, w którym każdy wierzchołek
grafu jest odwiedzony dokładnie raz. Czyli rozwiązaniem problemu komiwojażera
jest cykl o najmniejszej sumie wag krawędzi grafu. Liczba różnych cyklów
Hamiltona $H$ dla pełnego grafu nieskierowanego o $n$ wierzchołkach jest
wyrażana równaniem \cref{equ:n_cycles}.
\begin{equation}
    H = \frac{\left(n - 1\right)!}{2}
    \label{equ:n_cycles}
\end{equation}
Z uwagi na liczbę różnych cyklów, przeszukiwanie wszystkich rozwiązań jest
fizycznie niemożliwe dla większych grafów. Przykładowo stosunkowo mały graf o
stu wierzchołkach, daje w przybliżeniu $4,7 \times  10^{155}$ rozwiązań. Dla
przybliżenia zakładając, że sprawdzenie jednej ścieżki zajmuje $1 \, \mu s$,
przeanalizowanie wszystkich ścieżek zajęłoby $1,48 \times  10^{142} \, lat$.
Z tego powodu ważne jest zastosowanie bardziej skomplikowanych algorytmów
minimalizacyjnych, takich jak właśnie programowanie genetyczne. Dobrze
skonstruowany algorytm powinien być w stanie znaleźć minimum globalne dla
większości przypadków lub przynajmniej optymalne rozwiązanie.

Napisany algorytm będzie testowany na danych z
{\color{blue} \href{https://www.math.uwaterloo.ca/tsp/vlsi/index.html}
{www.math.uwaterloo.ca}} w celu weryfikacji jego działania.

\section{Implementacja}

Jak zostało wspomniane na wstępie, rozwiązaniem problemu komiwojażera jest
najkrótszy cykl Hamiltona dla danego pełnego, ważonego i nieskierowanego grafu.
Z tych informacji wynikają szczegóły implementacji takie jak funkcja
przystosowania, reprezentacja osobników oraz ograniczenia co do sposobu mutacji,
oraz krzyżowania osobników.

Ponieważ szukany jest cykl Hamiltona, w rozwiązaniu
każdy wierzchołek grafu pojawi się tylko raz, to znaczy, że mając graf $G$ o $N$
wierzchołkach:
\begin{equation}
    V\left(G\right) = \left\{ v_1 \, v_2 \, \cdots v_N \right\},
\end{equation}
rozwiązaniem będzie pewna permutacja zbioru $V\left(G\right)$. Z uwagi na to,
najłatwiej jest wykorzystać kodowanie całkowitoliczbowe. Z tym kodowaniem każdy
wierzchołek dostaje swój indeks, a następnie każdy osobnik składa się z pewnej
permutacji wierzchołków grafu, reprezentując pojedynczy cykl Hamiltona.

Mając zdefiniowany sposób zapisu osobników, można w oparciu o to zdefiniować
funkcję przystosowania $f \left( x \right)$ dla osobnika $x$. Najpierw jednak
należy zdefiniować funkcję kosztu $u \left( x \right)$. Ponieważ pojedynczy
osobnik składa się z kolejnych indeksów wierzchołków, funkcją kosztu jest
suma wag krawędzi pomiędzy kolejnymi wierzchołkami, oraz dodatkowo pomiędzy
pierwszym a ostatnim wierzchołkiem w osobniku (szukany jest cykl grafu).
Następnie funkcja przystosowania $f \left( x \right)$ jest następująca:
\begin{equation}
    f \left( x \right) = C_{max} - u \left( x \right),
\end{equation}
gdzie:
\begin{itemize}
    \item[] $f \left( x \right)$ - funkcja przystosowania,
    \item[] $u \left( x \right)$ - funkcja kosztu,
    \item[] $C_{max}$ - parametr nie mniejszy niż maksymalna wartość
            $u \left( x \right)$ dla danej aktualnej populacji,
    \item[] $x$ - osobnik.
\end{itemize}

Z uwagi na naturę rozwiązania, metody krzyżowania osobników są ograniczone,
ponieważ allele w nowopowstałym osobniku nie mogą się powtarzać. Dlatego
przykładowo krzyżowanie arytmetycznie się nie nadaje. Możliwe sposoby
krzyżowania to:
\begin{itemize}
    \item PMX,
    \item OX,
    \item CX.
\end{itemize}
W projekcie użyto krzyżowania OX, ponieważ ta metoda krzyżowania najbardziej
zachowuje kolejność alleli w osobniku. Zamysł jest taki, aby osobniki wymieniały
się krótkimi trasami, zachowując ich kolejność. Dany osobnik na początku
działania algorytmu będzie miał zoptymalizowany tylko fragment trasy. Krzyżując
dwa osobniki, jest spora szansa, że ten fragment się zachowa i trafi do
kolejnego osobnika. Za mieszanie kolejności raczej powinny być odpowiedzialne
mutacje osobników. Metody krzyżowania PMX oraz OX za bardzo zmieniają szyk
alleli, przez co nie zostały wykorzystane.

Podobnie jak w przypadku krzyżowania, osobniki po mutacji dalej muszą tworzyć
poprawny ciąg Hamiltona. Z tego powodu mutacje ograniczają się do podmian
elementów w strukturze osobnika, bez zmian ich wartości. Dopuszczalne sposoby
mutacji to:
\begin{itemize}
    \item inwersja (ang. inversion),
    \item wstawianie (ang. insertion),
    \item przenoszenie (ang. displacement),
    \item wzajemna wymiana (ang. reciprocal exchange).
\end{itemize}
W projekcie użyto inwersji oraz wstawiania. Przy mutacji, szczególnie w
początkowej fazie działania algorytmu, ważne jest, aby mutacje miały charakter
globalny. Inwersja polega na wylosowaniu podciągu w osobniku i odwrócenie w nim
kolejności alleli, natomiast wstawianie polega na wylosowaniu pojedynczego
allela, i wstawienie go w innym, losowo wybranym miejscu. Wstawianie pozwala na
stworzenie nowych tras w osobnikach, tak zmiany są małe i algorytm przy tylko
takim rodzaju mutacji, szybko się zbiega do minimum lokalnego. Dlatego, aby
troch zwiększyć szansę na znalezienie innego, lepszego minimum, została dodana
inwersja. Ponieważ zmiany przy inwersji są bardziej drastyczne, jest większa
szansa, że populacja nie utknie od razu w minimum lokalnym. To czy zostanie
wykonana inwersja czy wstawianie też zależy od obecnej iteracji. Im wyższa
iteracja, tym większa szansa, że zostanie wykonane wstawianie zamiast inwersji.

Przy tworzeniu nowych osobników również trzeba uważać, aby nie tworzyć elity.
Zostawianie i krzyżowanie tylko najlepszych osobników, prowadzi do
przedwczesnego zbiegania się algorytmu do nieoptymalnego rozwiązania. Dlatego
osobniki są niszowane w ten sposób, że osobniki z gorszym przystosowaniu mają
większą szansę na trafienie do puli rodzicielskiej. W odwrotnej konfiguracji,
gdzie lepsze osobniki miały większą szansę na trafienie do puli rodzicielskiej,
algorytm przedwcześnie się zbiegał do suboptymlanego rozwiązania. Następnie po
przeprowadzeniu krzyżowania i wyznaczeniu nowych osobników, są one poddawane
mutacji. Po krzyżowaniu oraz mutacji są pozostawiani rodzice lub potomkowie, w
zależności od tego, który osobnik jest lepszy.

\section{Wyniki pracy}

\end{document}